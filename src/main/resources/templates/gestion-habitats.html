<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Arcadia - Index</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link th:src="@{/img/favicon.png}" src="../static/img/favicon.png" rel="icon">
  <link th:src="@{/img/apple-touch-icon.png}" src="../static/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Sofia+Sans:ital,wght@0,1..1000;1,1..1000&display=swap"
    th:href="@{https://fonts.googleapis.com/css2?family=Sofia+Sans:ital,wght@0,1..1000;1,1..1000&display=swap}"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link th:href="@{/vendor/aos/aos.css}" href="../static/vendor/aos/aos.css" rel="stylesheet">
  <link th:href="@{/vendor/bootstrap/css/bootstrap.min.css}" href="../static/vendor/bootstrap/css/bootstrap.min.css"
    rel="stylesheet">
  <link th:href="@{/vendor/bootstrap-icons/bootstrap-icons.css}"
    href="../static/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link th:href="@{/vendor/boxicons/css/boxicons.min.css}" href="../static/vendor/boxicons/css/boxicons.min.css"
    rel="stylesheet">
  <link th:href="@{/vendor/glightbox/css/glightbox.min.css}" href="../static/vendor/glightbox/css/glightbox.min.css"
    rel="stylesheet">
  <link th:href="@{/vendor/swiper/swiper-bundle.min.css}" href="../static/vendor/swiper/swiper-bundle.min.css"
    rel="stylesheet">

  <!-- Main CSS File -->
  <link th:href="@{/css/style.css}" href="../static/css/style.css" rel="stylesheet">
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center">
    <div class="container d-flex align-items-center">

      <div class="logo me-auto">
        <h1><a th:href="accueil" href="accueil.html">Arcadia</a></h1>
      </div>

      <nav id="navbar" class="navbar order-last order-lg-0">
        <ul>
          <li><a class="nav-link" th:href="accueil" href="./accueil.html">Accueil</a></li>
          <li><a class="nav-link" th:href="services" href="./services.html">Nos services</a></li>
          <li><a class="nav-link" th:href="habitats" href="./habitats.html">Nos habitats</a></li>
          <li><a class="nav-link" th:href="contact" href="./contact.html">Contact</a></li>
          <li sec:authorize="!isAuthenticated()">
            <a class="nav-link" th:href="login" href="./login.html" >Se connecter</a>
          </li>
          <li sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" class="dropdown"><a href="#"><span>Espace administrateur</span> <i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a class="nav-link" th:href="gestion-utilisateurs" href="./gestion-utilisateurs.html">Gestion
                des utilisateurs</a></li>
              <li><a class="nav-link" th:href="gestion-services" href="./gestion-services.html">Gestion des services</a>
              </li>
              <li><a class="nav-link active" th:href="gestion-habitats" href="./gestion-habitats.html">Gestion des habitats</a>
              </li>
              <li><a class="nav-link" th:href="gestion-animaux" href="./gestion-animaux.html">Gestion des animaux</a>
              </li>
              <li><a class="nav-link" th:href="gestion-races" href="./gestion-races.html">Gestion des races</a>
              </li>
              <li><a class="nav-link" th:href="gestion-horaires" href="./gestion-horaires.html">Gestion des horaires</a>
              </li>
              <li><a class="nav-link" th:href="visualisation-rapports"
                     href="./visualisation-rapports.html">Visualisation des rapports</a></li>
            </ul>
          </li>
          <li sec:authorize="hasRole('ROLE_EMPLOYE')" class="dropdown"><a href="#"><span>Espace employé</span> <i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a class="nav-link" th:href="gestion-avis" href="./gestion-avis.html">Gestion
                des avis</a></li>
              <li><a class="nav-link" th:href="gestion-services" href="./gestion-services.html">Gestion des
                services</a>
              </li>
              <li><a class="nav-link" th:href="ajout-alimentation" href="./ajout-alimentation.html">Ajout de
                l'alimentation</a>
              </li>
            </ul>
          </li>
          <li sec:authorize="hasRole('ROLE_VETERINAIRE')" class="dropdown"><a href="#"><span>Espace vétérinaire</span> <i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a class="nav-link" th:href="ajout-rapport" href="./ajout-rapport.html">Ajout d'un rapport</a></li>
              <li><a class="nav-link active" th:href="gestion-habitats" href="./gestion-habitats.html">Gestion des habitats</a>
              </li>
              <li><a class="nav-link" th:href="visualisation-alimentations" href="./visualisation-alimentations.html">Visualisation des alimentations</a>
              </li>
            </ul>
          </li>
          <li sec:authorize="isAuthenticated()"><form th:action="@{logout}" method="post"> <button class="btn">Se déconnecter</button></form></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->

  <main id="main">

    <!-- ======= Habitats Section ======= -->
    <section class="description">
      <div class="align-items-center mt-5">
        <div class="container mt-5 px-2">
          <h3>Gestion des habitats</h3>
          <div class="mb-2 d-flex justify-content-between align-items-center">
            <div class="position-relative">
              <span class="position-absolute search"><i class="fa fa-search"></i></span>
              <input id="habitatsFilter" class="form-control w-100"
                onkeyup="filtreGenerique('habitatsFilter', 'habitatsTable', 0, 1)"
                placeholder="Rechercher par id ou nom">
            </div>
            <div sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" class="px-2">
              <button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                      data-bs-target="#habitatModal">Ajouter un habitat</button>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-responsive" id="habitatsTable">

              <thead>
                <tr class="bg-light">
                  <th scope="col" width="5%">#</th>
                  <th scope="col" width="15%">Nom</th>
                  <th scope="col" width="25%">Description</th>
                  <th scope="col" width="25%">Commentaire</th>
                  <th sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" scope="col" width="10%">Images</th>
                  <th scope="col" class="text-end" width="10%">Modifier</th>
                  <th sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" scope="col" class="text-end" width="10%">Supprimer</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="habitat:${listeHabitat}">
                  <td th:text="${habitat.id}"><span></span></td>
                  <td th:text="${habitat.nom}"><span></span></td>
                  <td th:text="${habitat.description}"><span></span></td>
                  <td th:text="${habitat.commentaireHabitat}"><span></span></td>
                  <td sec:authorize="hasRole('ROLE_ADMINISTRATEUR')"><span>0&nbsp;<button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                       th:attr="data-bs-target='#modifierImageHabitatModal'+${habitat.id}"><i class="bi bi-pencil"></i></button></span></td>
                  <td class="text-end"><button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                       th:attr="data-bs-target='#modifierHabitatModal'+${habitat.id}"><i class="bi bi-pencil"></i></button></td>
                  <td sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" class="text-end"><span><button class="btn btn-primary custom-primary-button"
                        data-bs-toggle="modal"  th:attr="data-bs-target='#suppressionModal' + ${habitat.id}"><i
                          class="bi bi-x-lg"></i></button></span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </div>
    </section>

    <!-- Modals -->
    <div sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" class="modal fade" id="habitatModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form action="#" th:action="@{creerHabitatModel}" method="post" th:object="${nouvelHabitat}">
            <div class="modal-header">
              <h5 class="modal-title">Habitat</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label class="col-form-label">Nom:</label>
                <input maxlength="50" type="text" class="form-control" required th:field="*{nom}">
              </div>
              <div class="mb-3">
                <label class="col-form-label">Description:</label>
                <textarea maxlength="500" class="form-control" required th:field="*{description}"></textarea>
              </div>
              <div class="mb-3">
                <label class="col-form-label">Commentaire:</label>
                <textarea maxlength="500" class="form-control" required th:field="*{commentaireHabitat}"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
              <button type="submit" class="btn btn-primary custom-primary-button">Envoyer</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="modal fade" th:each="habitat:${listeHabitat}"
         th:attr="id='modifierHabitatModal' + ${habitat.id}" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content" sec:authorize="hasRole('ROLE_ADMINISTRATEUR')">
          <form  action="#" th:action="@{'modifierHabitatModel/'+${habitat.id}}" method="post" >
            <div class="modal-header">
              <h5 class="modal-title">Habitat</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label class="col-form-label">Nom:</label>
                <input maxlength="50" type="text" class="form-control" required th:name="nom" th:value="${habitat.nom}">
              </div>
              <div class="mb-3">
                <label class="col-form-label">Description:</label>
                <textarea maxlength="500" class="form-control" required th:name="description" th:text="${habitat.description}"></textarea>

              </div>
              <div class="mb-3">
                <label class="col-form-label">Commentaire:</label>
                <textarea maxlength="500" class="form-control" required th:name="commentaireHabitat" th:text="${habitat.commentaireHabitat}"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
              <button type="submit" class="btn btn-primary custom-primary-button">Envoyer</button>
            </div>
          </form>
        </div>
        <div class="modal-content" sec:authorize="hasRole('ROLE_VETERINAIRE')" >
            <form sec:authorize="hasRole('ROLE_VETERINAIRE')" action="#" th:action="@{'modifierCommentaireModel/'+${habitat.id}}" method="post">
              <div class="modal-header">
                <h5 class="modal-title">Habitat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="mb-3">
                  <label class="col-form-label">Nom:</label>
                  <input maxlength="50" type="text" class="form-control" required th:name="nom" th:value="${habitat.nom}" disabled>
                </div>
                <div class="mb-3">
                  <label class="col-form-label">Description:</label>
                  <textarea maxlength="500" class="form-control" required th:name="description" th:text="${habitat.description}" disabled></textarea>
                </div>
                <div class="mb-3">
                  <label class="col-form-label">Commentaire:</label>
                  <textarea maxlength="500" class="form-control" required th:name="commentaireHabitat" th:text="${habitat.commentaireHabitat}"></textarea>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                <button type="submit" class="btn btn-primary custom-primary-button">Envoyer</button>
              </div>
            </form>
        </div>
      </div>
    </div>

    <div sec:authorize="hasRole('ROLE_ADMINISTRATEUR')" class="modal fade" th:each="habitat:${listeHabitat}" th:attr="id='modifierImageHabitatModal' + ${habitat.id}" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" >Images habitat</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <div class="image-slider swiper">
                <div class="swiper-wrapper align-items-center">

                  <div class="swiper-slide" th:if="${habitat.images.size() >= 1}">
                    <img th:if="${habitat.images.size() >= 1}" th:src="@{'/image/' + ${habitat.imagesArray[0].getId()}}" alt="Image" >
                    <div class="text-center mt-3">
                      <form  th:action="@{'supprimerImageHabitatModel/' + ${habitat.imagesArray[0].getId()}}" method="get">
                        <button type="submit" class="btn btn-primary custom-primary-button"
                         >Supprimer</button>
                      </form>
                    </div>
                  </div>

                  <div class="swiper-slide" th:unless="${habitat.images.size() >= 1}">
                    <div class="text-center mt-3">
                      <form enctype="multipart/form-data" action='#' th:action="@{'creerImageHabitat/' + ${habitat.id}}" method="post">
                        <input class="form-control" type="file" th:name="file" name="file">
                        <button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                                >Insérer</button>
                      </form>
                    </div>
                  </div>

                  <div class="swiper-slide" th:if="${habitat.images.size() >= 2}">
                    <img th:if="${habitat.images.size() >= 2}" th:src="@{'/image/' + ${habitat.imagesArray[1].getId()}}" alt="Image" >
                    <div class="text-center mt-3">
                      <form th:action="@{'supprimerImageHabitatModel/' + ${habitat.imagesArray[1].getId()}}" method="get">
                        <button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                                >Supprimer</button>
                      </form>
                    </div>
                  </div>

                  <div class="swiper-slide" th:unless="${habitat.images.size() >= 2}">
                    <div class="text-center mt-3">
                      <form enctype="multipart/form-data" action='#' th:action="@{'creerImageHabitat/' + ${habitat.id}}" method="post">
                        <input class="form-control" type="file" th:name="file" name="file">
                        <button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                               >Insérer</button>
                      </form>
                    </div>
                  </div>

                  <div class="swiper-slide" th:if="${habitat.images.size() >= 3}">
                    <img th:if="${habitat.images.size() >= 3}" th:src="@{'/image/' + ${habitat.imagesArray[2].getId()}}" alt="Image" >
                    <div class="text-center mt-3">
                      <form th:action="@{'supprimerImageHabitatModel/' + ${habitat.imagesArray[2].getId()}}" method="get">
                        <button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                               >Supprimer</button>
                      </form>
                    </div>
                  </div>

                  <div class="swiper-slide" th:unless="${habitat.images.size() >= 3}">
                    <div class="text-center mt-3">
                      <form enctype="multipart/form-data" action='#' th:action="@{'creerImageHabitat/' + ${habitat.id}}" method="post">
                        <input class="form-control" type="file" th:name="file" name="file">
                        <button class="btn btn-primary custom-primary-button" data-bs-toggle="modal"
                               >Insérer</button>
                      </form>
                    </div>
                  </div>

                </div>
                <div class="swiper-pagination"></div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="modal fade" id="suppressionModal" tabindex="-1" aria-hidden="true" th:each="habitat:${listeHabitat}"
         th:attr="id='suppressionModal' + ${habitat.id}">
      <div class="modal-dialog">
        <div class="modal-content">
          <form action="#" th:action="@{'supprimerHabitatModel/'+${habitat.id}}" method="get">
            <div class="modal-header">
              <h5 class="modal-title" id="habitatModalLabel">Confirmation</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="row">
                <span>Êtes vous sûr de vouloir supprimer?</span>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Non</button>
              <button type="submit" class="btn btn-primary custom-primary-button">Oui</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- End Modals -->
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="mt-3">
    <div class="container">
      <div class="copyright">
        &copy; Copyright <strong><span>Arcadia</span></strong>. All Rights Reserved
      </div>
    </div>
  </footer><!-- End Footer -->

  <!-- Vendor JS Files -->
  <script th:src="@{/vendor/aos/aos.js}" src="../static/vendor/aos/aos.js"></script>
  <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"
    src="../static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script th:src="@{/vendor/glightbox/js/glightbox.min.js}"
    src="../static/vendor/glightbox/js/glightbox.min.js"></script>
  <script th:src="@{/vendor/isotope-layout/isotope.pkgd.min.js}"
    src="../static/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script th:src="@{/vendor/swiper/swiper-bundle.min.js}" src="../static/vendor/swiper/swiper-bundle.min.js"></script>

  <!-- Main JS File -->
  <script th:src="@{/js/main.js}" src="../static/js/main.js"></script>

</body>

</html>